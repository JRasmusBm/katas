/*
https://www.codewars.com/kata/60384d957d61790018e627ff

# INPUT: 

CREATE TABLE market_data
(
    price      numeric,
    createdAt  timestamp
);

# EXAMPLE

+----------------+--------------------------+
|price           |createdAt                 |
+----------------+--------------------------+
|11.2728020498136|2021-01-01 00:00:00.000000|
|9.41117392685891|2021-01-01 00:01:00.000000|
|9.92312078458682|2021-01-01 00:02:00.000000|
|9.1424414472387 |2021-01-01 00:03:00.000000|
|8.9221363628754 |2021-01-01 00:04:00.000000|
|11.2749453064788|2021-01-01 00:05:00.000000|
|11.2928440441844|2021-01-01 00:06:00.000000|

# OUTPUT

Must be ordered by `date asc`

+--------------------------+----------------+----------------+----------------+----------------+
|date                      |open            |close           |high            |low             |
+--------------------------+----------------+----------------+----------------+----------------+
|2021-01-01 00:00:00.000000|11.2728020498136|11.2749453064788|11.2749453064788|8.9221363628754 |
|2021-01-01 00:05:00.000000|11.2749453064788|10.7887252777765|11.2928440441844|8.77254646493638|
|2021-01-01 00:10:00.000000|10.7887252777765|8.900243074681  |11.4055309409346|8.900243074681  |
|2021-01-01 00:15:00.000000|8.900243074681  |9.69509642808362|11.0260860899827|8.89806920495255|
|2021-01-01 00:20:00.000000|9.69509642808362|8.86863338521832|11.1783686466807|8.86863338521832|
|2021-01-01 00:25:00.000000|8.86863338521832|10.2083466838747|10.6498426233299|8.86863338521832|
|2021-01-01 00:30:00.000000|10.2083466838747|9.46371152314674|11.2227570474952|9.46371152314674|
|2021-01-01 00:35:00.000000|9.46371152314674|10.5523666010627|10.7712448995649|9.00495925560391|
|2021-01-01 00:40:00.000000|10.5523666010627|8.64966238997734|11.2679984946793|8.64966238997734|
...
*/



SELECT 
  TO_TIMESTAMP(FLOOR((EXTRACT('epoch' from createdAt) / 300 )) * 300) as date,
  MAX(price) as high,
  MIN(price) as low,
  MAX(price) as open,
  MAX(price) as close
FROM market_data
GROUP BY date
ORDER BY date ASC;
